{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}


{% block content %}
<!-- Displaying Bookings -->
<!-- Credit: This section was inspired by the comments code in I think therefore I blog -->
<!-- Credit: https://github.com/Code-Institute-Solutions/blog/blob/main/12_views_part_3/05_edit_delete/blog/templates/blog/post_detail.html#L45 -->
<div class="col-md-4 card mb-4 mt-3">
    <div class="card-body">
        <h1 class="appointment-title">Book an Appointment</h1>
        <form method="POST" class="appointment-form">
            {% csrf_token %}
            <div class="form-fields">
                {{ form.as_p }}
            </div>
            <button id="submitButton" type="submit" class="btn btn-signup btn-lg">Lets Book!</button>
        </form>
    </div>
</div>
</div>
<div class="row" id="booking-list">
    <div class="col-md-8 card mb-4 mt-3">
        <div class="card-body">
            {% if user.is_authenticated %}
            <h3>List of Your Bookings:</h3>
            <hr />
            <p>
                <i class="fa-regular fa-clipboard"></i>
                <strong>Please note:</strong> Booking will turn from colored text to
                black when confirmed.
            </p>
            {% for booking in bookings %}
            <div class="col-12 col-md-8 booking-item {% if not booking.confirmed %} faded{% endif %}"
                id="booking{{ booking.id }}">
                <h4 class="service-type">{{ booking.service_type}}</h4>
                {% if not booking.confirmed %}
                <p>
                    <i class="fa-solid fa-circle-exclamation"></i><strong> UNCONFIRMED</strong>
                </p>
                {% endif %}
                <p><strong>Name:</strong> {{ booking.username }}</p>
                <p><strong>Date:</strong> {{ booking.date_of_booking}}</p>
                <p class="start-time">
                    <strong>Time:</strong> {{ booking.start_time}}
                </p>
                <div><strong>Your message:</strong></div>
                <div class="booking-message">{{ booking.message | linebreaks }}</div>
                <hr />
                <div class="text-center">
                    <a href="{% url 'edit_booking' booking.id %}" class="btn btn-edit-makeover">Edit</a>
                    <a href="{% url 'delete_booking' booking.id %}" class="btn btn-delete-makeover">Delete</a>
                </div>
            </div>
            {% endfor %} {% elif not user.is_authenticated %}
            <p>Log in to view your booking</p>
            {% endif %}
        </div>
    </div>
    <div>
        {% endblock %}